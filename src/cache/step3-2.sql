
--
-- Script generated by datapackage.json files and pack2sql generator.
-- Created in 2017-10-20
--

	CREATE EXTENSION IF NOT EXISTS file_fdw;
	-- DROP SERVER IF EXISTS csv_files CASCADE; -- danger when using with other tools.
	CREATE SERVER csv_files FOREIGN DATA WRAPPER file_fdw;


-- -- -- country_codes -- -- --

	   INSERT INTO dataset.meta(tmp_name,info) VALUES ('country_codes','{"name":"country-codes","format":"csv","url":"https://raw.github.com/datasets/country-codes/master/data/country-codes.csv","path":"data/country-codes.csv","schema":{"fields":[{"name":"official_name_ar","title":"official name Arabic","description":"Country or Area official Arabic short name from UN Statistics Divsion","type":"string"},{"name":"official_name_cn","title":"official name Chinese","description":"Country or Area official Chinese short name from UN Statistics Divsion","type":"string"},{"name":"official_name_en","title":"official name English","description":"Country or Area official English short name from UN Statistics Divsion","type":"string"},{"name":"official_name_es","title":"official name Spanish","description":"Country or Area official Spanish short name from UN Statistics Divsion","type":"string"},{"name":"official_name_fr","title":"official name French","description":"Country or Area official French short name from UN Statistics Divsion","type":"string"},{"name":"official_name_ru","title":"official name Russian","description":"Country or Area official Russian short name from UN Statistics Divsion","type":"string"},{"name":"ISO3166-1-Alpha-2","title":"ISO3166-1-Alpha-2","description":"Alpha-2 codes from ISO 3166-1","type":"string","constraints":{"unique":true,"minLength":2,"maxLength":2}},{"name":"ISO3166-1-Alpha-3","title":"ISO3166-1-Alpha-3","description":"Alpha-3 codes from ISO 3166-1 (synonymous with World Bank Codes)","type":"string","constraints":{"unique":true,"minLength":3,"maxLength":3}},{"name":"ISO3166-1-numeric","title":"ISO3166-1-numeric","description":"Numeric codes from ISO 3166-1","type":"string"},{"name":"ISO4217-currency_alphabetic_code","title":"ISO4217-currency_alphabetic_code","description":"ISO 4217 currency alphabetic code","type":"string"},{"name":"ISO4217-currency_country_name","title":"ISO4217-currency_country_name","description":"ISO 4217 country name","type":"string"},{"name":"ISO4217-currency_minor_unit","title":"ISO4217-currency_minor_unit","description":"ISO 4217 currency number of minor units","type":"string"},{"name":"ISO4217-currency_name","title":"ISO4217-currency_name","description":"ISO 4217 currency name","type":"string"},{"name":"ISO4217-currency_numeric_code","title":"ISO4217-currency_numeric_code","description":"ISO 4217 currency numeric code","type":"string"},{"name":"M49","title":"M49","description":"UN Statistics M49 numeric codes (nearly synonymous with ISO 3166-1 numeric codes, which are based on UN M49. ISO 3166-1 does not include Channel Islands or Sark, for example)","type":"number","constraints":{"unique":true,"minLength":3,"maxLength":3}},{"name":"UNTERM Arabic Formal","title":"UNTERM Arabic Formal","description":"Country''s formal Arabic name from UN Protocol and Liaison Service","type":"string"},{"name":"UNTERM Arabic Short","title":"UNTERM Arabic Short","description":"Country''s short Arabic name from UN Protocol and Liaison Service","type":"string"},{"name":"UNTERM Chinese Formal","title":"UNTERM Chinese Formal","description":"Country''s formal Chinese name from UN Protocol and Liaison Service","type":"string"},{"name":"UNTERM Chinese Short","title":"UNTERM Chinese Short","description":"Country''s short Chinese name from UN Protocol and Liaison Service","type":"string"},{"name":"UNTERM English Formal","title":"UNTERM English Formal","description":"Country''s formal English name from UN Protocol and Liaison Service","type":"string"},{"name":"UNTERM English Short","title":"UNTERM English Short","description":"Country''s short English name from UN Protocol and Liaison Service","type":"string"},{"name":"UNTERM French Formal","title":"UNTERM French Formal","description":"Country''s formal French name from UN Protocol and Liaison Service","type":"string"},{"name":"UNTERM French Short","title":"UNTERM French Short","description":"Country''s short French name from UN Protocol and Liaison Service","type":"string"},{"name":"UNTERM Russian Formal","title":"UNTERM Russian Formal","description":"Country''s formal Russian name from UN Protocol and Liaison Service","type":"string"},{"name":"UNTERM Russian Short","title":"UNTERM Russian Short","description":"Country''s short Russian name from UN Protocol and Liaison Service","type":"string"},{"name":"UNTERM Spanish Formal","title":"UNTERM Spanish Formal","description":"Country''s formal Spanish name from UN Protocol and Liaison Service","type":"string"},{"name":"UNTERM Spanish Short","title":"UNTERM Spanish Short","description":"Country''s short Spanish name from UN Protocol and Liaison Service","type":"string"},{"name":"CLDR display name","title":"CLDR display name","description":"Country''s customary English short name (CLDR)","type":"string"},{"name":"Capital","title":"capital city","description":"Capital city from Geonames","type":"string"},{"name":"Continent","title":"continent","description":"Continent from Geonames","type":"string","constraints":{"minLength":2,"maxLength":2}},{"name":"DS","title":"distinguishing signs of vehicles","description":"Distinguishing signs of vehicles in international traffic","type":"string"},{"name":"Developed / Developing Countries","title":"developed or developing country","description":"Country classification from United Nations Statistics Division","type":"string","constraints":{"enum":["Developing","Developed"]}},{"name":"Dial","title":"telephone dialing code","description":"Country code from ITU-T recommendation E.164, sometimes followed by area code","type":"string"},{"name":"EDGAR","title":"EDGAR code","description":"EDGAR country code from SEC","type":"string","constraints":{"unique":true,"minLength":2,"maxLength":2}},{"name":"FIFA","title":"FIFA code","description":"Codes assigned by the Fédération Internationale de Football Association","type":"string","constraints":{"unique":true}},{"name":"FIPS","title":"FIPS code","description":"Codes from the U.S. standard FIPS PUB 10-4","type":"string"},{"name":"GAUL","title":"GAUL code","description":"Global Administrative Unit Layers from the Food and Agriculture Organization","type":"string","constraints":{"unique":true}},{"name":"Geoname ID","title":"Geoname ID","description":"Geoname ID","type":"number","constraints":{"unique":true}},{"name":"Global Code","title":"global code","description":"Country classification from United Nations Statistics Division","type":"string"},{"name":"Global Name","title":"global name","description":"Country classification from United Nations Statistics Division","type":"string"},{"name":"IOC","title":"IOC code","description":"Codes assigned by the International Olympics Committee","type":"string","constraints":{"unique":true,"minLength":3,"maxLength":3}},{"name":"ITU","title":"ITU code","description":"Codes assigned by the International Telecommunications Union","type":"string"},{"name":"Intermediate Region Code","title":"intermediate region code","description":"Country classification from United Nations Statistics Division","type":"string"},{"name":"Intermediate Region Name","title":"intermediate region name","description":"Country classification from United Nations Statistics Division","type":"string"},{"name":"Land Locked Developing Countries (LLDC)","title":"land locked developing country (LLDC)","description":"Country classification from United Nations Statistics Division","type":"string"},{"name":"Languages","title":"languages","description":"Languages from Geonames","type":"string"},{"name":"Least Developed Countries (LDC)","title":"least developed country (LDC)","description":"Country classification from United Nations Statistics Division","type":"string"},{"name":"MARC","title":"MARC code","description":"MAchine-Readable Cataloging codes from the Library of Congress","type":"string"},{"name":"Region Code","title":"region code","description":"Country classification from United Nations Statistics Division","type":"string"},{"name":"Region Name","title":"region name","description":"Country classification from United Nations Statistics Division","type":"string"},{"name":"Small Island Developing States (SIDS)","title":"small island developing state (SIDS)","description":"Country classification from United Nations Statistics Division","type":"string"},{"name":"Sub-region Code","title":"sub-region code","description":"Country classification from United Nations Statistics Division","type":"string"},{"name":"Sub-region Name","title":"sub-region name","description":"Country classification from United Nations Statistics Division","type":"string"},{"name":"TLD","title":"TLD","description":"Top level domain from Geonames","type":"string"},{"name":"WMO","title":"WMO code","description":"Country abbreviations by the World Meteorological Organization","type":"string","constraints":{"minLength":2,"maxLength":2}},{"name":"is_independent","title":"independent country","description":"Country status, based on the CIA World Factbook","type":"string"}]}}'::jsonb);
	  
	 DROP FOREIGN TABLE IF EXISTS tmpcsv_country_codes CASCADE; -- danger drop VIEWS
	 CREATE FOREIGN TABLE tmpcsv_country_codes (
		official_name_ar text,
		official_name_cn text,
		official_name_en text,
		official_name_es text,
		official_name_fr text,
		official_name_ru text,
		iso3166_1_alpha_2 text,
		iso3166_1_alpha_3 text,
		iso3166_1_numeric text,
		iso4217_currency_alphabetic_code text,
		iso4217_currency_country_name text,
		iso4217_currency_minor_unit text,
		iso4217_currency_name text,
		iso4217_currency_numeric_code text,
		m49 float,
		unterm_arabic_formal text,
		unterm_arabic_short text,
		unterm_chinese_formal text,
		unterm_chinese_short text,
		unterm_english_formal text,
		unterm_english_short text,
		unterm_french_formal text,
		unterm_french_short text,
		unterm_russian_formal text,
		unterm_russian_short text,
		unterm_spanish_formal text,
		unterm_spanish_short text,
		cldr_display_name text,
		capital text,
		continent text,
		ds text,
		developed_developing_countries text,
		dial text,
		edgar text,
		fifa text,
		fips text,
		gaul text,
		geoname_id float,
		global_code text,
		global_name text,
		ioc text,
		itu text,
		intermediate_region_code text,
		intermediate_region_name text,
		land_locked_developing_countries_lldc_ text,
		languages text,
		least_developed_countries_ldc_ text,
		marc text,
		region_code text,
		region_name text,
		small_island_developing_states_sids_ text,
		sub_region_code text,
		sub_region_name text,
		tld text,
		wmo text,
		is_independent text
	  ) SERVER csv_files OPTIONS (
	     filename '/tmp/tmpcsv/country_codes.csv',
	     format 'csv',
	     header 'true'
	  );
	
	    INSERT INTO dataset.big(source, c)
	      SELECT dataset.idconfig('country_codes') , jsonb_build_array( official_name_ar, official_name_cn, official_name_en, official_name_es, official_name_fr, official_name_ru, iso3166_1_alpha_2, iso3166_1_alpha_3, iso3166_1_numeric, iso4217_currency_alphabetic_code, iso4217_currency_country_name, iso4217_currency_minor_unit, iso4217_currency_name, iso4217_currency_numeric_code, m49, unterm_arabic_formal, unterm_arabic_short, unterm_chinese_formal, unterm_chinese_short, unterm_english_formal, unterm_english_short, unterm_french_formal, unterm_french_short, unterm_russian_formal, unterm_russian_short, unterm_spanish_formal, unterm_spanish_short, cldr_display_name, capital, continent, ds, developed_developing_countries, dial, edgar, fifa, fips, gaul, geoname_id, global_code, global_name, ioc, itu, intermediate_region_code, intermediate_region_name, land_locked_developing_countries_lldc_, languages, least_developed_countries_ldc_, marc, region_code, region_name, small_island_developing_states_sids_, sub_region_code, sub_region_name, tld, wmo, is_independent   )
	      FROM tmpcsv_country_codes;
	  
	   DROP VIEW IF EXISTS dataset.vw_country_codes CASCADE; -- danger drop old dependents
	   CREATE VIEW dataset.vw_country_codes AS
		SELECT (c->>0)::text AS official_name_ar, (c->>1)::text AS official_name_cn, (c->>2)::text AS official_name_en, (c->>3)::text AS official_name_es, (c->>4)::text AS official_name_fr, (c->>5)::text AS official_name_ru, (c->>6)::text AS iso3166_1_alpha_2, (c->>7)::text AS iso3166_1_alpha_3, (c->>8)::text AS iso3166_1_numeric, (c->>9)::text AS iso4217_currency_alphabetic_code, (c->>10)::text AS iso4217_currency_country_name, (c->>11)::text AS iso4217_currency_minor_unit, (c->>12)::text AS iso4217_currency_name, (c->>13)::text AS iso4217_currency_numeric_code, (c->>14)::float AS m49, (c->>15)::text AS unterm_arabic_formal, (c->>16)::text AS unterm_arabic_short, (c->>17)::text AS unterm_chinese_formal, (c->>18)::text AS unterm_chinese_short, (c->>19)::text AS unterm_english_formal, (c->>20)::text AS unterm_english_short, (c->>21)::text AS unterm_french_formal, (c->>22)::text AS unterm_french_short, (c->>23)::text AS unterm_russian_formal, (c->>24)::text AS unterm_russian_short, (c->>25)::text AS unterm_spanish_formal, (c->>26)::text AS unterm_spanish_short, (c->>27)::text AS cldr_display_name, (c->>28)::text AS capital, (c->>29)::text AS continent, (c->>30)::text AS ds, (c->>31)::text AS developed_developing_countries, (c->>32)::text AS dial, (c->>33)::text AS edgar, (c->>34)::text AS fifa, (c->>35)::text AS fips, (c->>36)::text AS gaul, (c->>37)::float AS geoname_id, (c->>38)::text AS global_code, (c->>39)::text AS global_name, (c->>40)::text AS ioc, (c->>41)::text AS itu, (c->>42)::text AS intermediate_region_code, (c->>43)::text AS intermediate_region_name, (c->>44)::text AS land_locked_developing_countries_lldc_, (c->>45)::text AS languages, (c->>46)::text AS least_developed_countries_ldc_, (c->>47)::text AS marc, (c->>48)::text AS region_code, (c->>49)::text AS region_name, (c->>50)::text AS small_island_developing_states_sids_, (c->>51)::text AS sub_region_code, (c->>52)::text AS sub_region_name, (c->>53)::text AS tld, (c->>54)::text AS wmo, (c->>55)::text AS is_independent
		FROM dataset.big where source=dataset.idconfig('country_codes') ORDER BY id;
	  

-- -- -- br_state_codes -- -- --

	   INSERT INTO dataset.meta(tmp_name,info) VALUES ('br_state_codes','{"name":"br-state-codes","path":"data/br-state-codes.csv","format":"csv","mediatype":"text/csv","rdfType":"http://schema.org/State","lang":"en","schema":{"fields":[{"name":"subdivision","description":"State-name 2-letter abbreviation (in portuguese ''sigla da unidade da federação''), ISO 3166:BR","rdfType":"https://www.wikidata.org/wiki/Q27798","type":"string","title-pt":"Subdivisão (UF)","title":"Subdivision (Federal Unit)","regex":"^[A-Z]{2,2}$"},{"name":"name_prefix","description":"Name prefix, in portuguese","rdfType-prop":"http://schema.org/name","title-pt":"Prefixo","title":"Prefix","type":"string"},{"name":"name","description":"Common name of the state, in portuguese","rdfType-prop":"http://schema.org/name","title-pt":"Nome","title":"Name","type":"string"},{"name":"id","rdfType-prop":"http://schema.org/identifier","title-pt":"ID serial","title":"Serial ID","description":"Short serial ID for subdivisions, starting from 1 (for base36 subtract 1). Historic (non-current) starting from 30.","type":"integer"},{"name":"idIBGE","description":"IBGE statdandard identifier","url":"http://www.ibge.gov.br/home/geociencias/areaterritorial/principal.shtm","title-pt":"ID IBGE","title":"ID of IBGE","type":"string"},{"name":"wdId","description":"Wikidata concept (semantic) identifier","urlTpl":"https://www.wikidata.org/wiki/{value}","title-pt":"ID Wikidata","title":"Wikidata ID","type":"string"},{"name":"lexLabel","description":"Brazilian''s LEX URN syntax translation of the official state name. Used in URLs and other contexts","url":"http://projeto.lexml.gov.br","title-pt":"Rótulo para URN-LEX","title":"Label for URN-LEX","type":"string"},{"name":"creation","description":"State official creation year","rdfType-prop":"http://schema.org/startDate","title-pt":"Ano de criação","title":"Creation year","type":"integer"},{"name":"extinction","description":"State official creation year (null for in use)","rdfType-prop":"http://schema.org/endDate","title-pt":"Ano de extinção","title":"Extinction year","type":"integer"},{"name":"category","description":"Subdivision category (see ISO 3166-2)","title-pt":"Última classificação de nível","title":"Category","type":"string"},{"name":"timeZone","description":"Time Zone standard label","rdfType":"https://www.wikidata.org/wiki/Q12143","title-pt":"Fuso horário de referência","title":"Time Zone (reference city)","type":"string"},{"name":"utcOffset","description":"UTC offset","rdfType":"https://www.wikidata.org/wiki/Q187110","title-pt":"Diferença com relação ao UTC","title":"UTC offset","type":"integer"},{"name":"utcOffset_DST","description":"UTC offset at summer (when using Daylight Saving Time - DST)","rdfType":"https://www.wikidata.org/wiki/Q187110","rdfType-ref":"https://www.wikidata.org/wiki/Q36669","title-pt":"Diferença no verão","title":"UTC offset at DST","type":"integer"},{"name":"postalCode_ranges","description":"Numeric ranges of postal codes","rdfType-ref":"https://schema.org/postalCode","title-pt":"Intervalos de CEP","title":"Postal-code ranges","type":"string"},{"name":"notes","description":"Notes about assegments, dates or changes","rdfType-prop":"http://schema.org/commentText","title-pt":"Notas","title":"Notes","type":"string"}]},"primaryKey":"id"}'::jsonb);
	  
	 DROP FOREIGN TABLE IF EXISTS tmpcsv_br_state_codes CASCADE; -- danger drop VIEWS
	 CREATE FOREIGN TABLE tmpcsv_br_state_codes (
		subdivision text,
		name_prefix text,
		name text,
		id integer,
		idibge text,
		wdid text,
		lexlabel text,
		creation integer,
		extinction integer,
		category text,
		timezone text,
		utcoffset integer,
		utcoffset_dst integer,
		postalcode_ranges text,
		notes text
	  ) SERVER csv_files OPTIONS (
	     filename '/tmp/tmpcsv/br_state_codes.csv',
	     format 'csv',
	     header 'true'
	  );
	
	    INSERT INTO dataset.big(source,key, c)
	      SELECT dataset.idconfig('br_state_codes') , concat(id::text), jsonb_build_array( subdivision, name_prefix, name, id, idibge, wdid, lexlabel, creation, extinction, category, timezone, utcoffset, utcoffset_dst, postalcode_ranges, notes   )
	      FROM tmpcsv_br_state_codes;
	  
	   DROP VIEW IF EXISTS dataset.vw_br_state_codes CASCADE; -- danger drop old dependents
	   CREATE VIEW dataset.vw_br_state_codes AS
		SELECT (c->>0)::text AS subdivision, (c->>1)::text AS name_prefix, (c->>2)::text AS name, (c->>3)::integer AS id, (c->>4)::text AS idibge, (c->>5)::text AS wdid, (c->>6)::text AS lexlabel, (c->>7)::integer AS creation, (c->>8)::integer AS extinction, (c->>9)::text AS category, (c->>10)::text AS timezone, (c->>11)::integer AS utcoffset, (c->>12)::integer AS utcoffset_dst, (c->>13)::text AS postalcode_ranges, (c->>14)::text AS notes
		FROM dataset.big where source=dataset.idconfig('br_state_codes') ORDER BY 4;
	  

-- -- -- br_city_synonyms -- -- --

	   INSERT INTO dataset.meta(tmp_name,info) VALUES ('br_city_synonyms','{"name":"br-city-synonyms.csv","path":"data/br-city-synonyms.csv","format":"csv","mediatype":"text/csv","rdfType":"https://www.wikidata.org/wiki/Q42106","lang":"pt","schema":{"fields":[{"name":"state","description":"State-name 2-letter abbreviation (in portuguese ''sigla da unidade da federação''), ISO 3166:BR","rdfType":"https://www.wikidata.org/wiki/Q27798","type":"string","title-pt":"Subdivisão (UF)","title":"Subdivision (Federal Unit)","regex":"^[A-Z]{2,2}$"},{"name":"lexLabel","description":"Brazilian''s LEX URN syntax translation of the official state name. Used in URLs and other contexts","url":"http://projeto.lexml.gov.br","title-pt":"Rótulo para URN-LEX","title":"Label for URN-LEX","type":"string"},{"name":"synonym","description":"Usual synonym of the name of the city, in portuguese","rdfType-prop":"http://schema.org/name","title-pt":"Sinônimo","title":"Synonym","type":"string"},{"name":"type","description":"Synonym type","title-pt":"Tipo","title":"Type","type":"string"},{"name":"ref","description":"source of use or reference (uri or controlled name)","title-pt":"Referência de uso","title":"Source or reference","type":"string"}]},"primaryKey":["state","lexLabel","synonym"]}'::jsonb);
	  
	 DROP FOREIGN TABLE IF EXISTS tmpcsv_br_city_synonyms CASCADE; -- danger drop VIEWS
	 CREATE FOREIGN TABLE tmpcsv_br_city_synonyms (
		state text,
		lexlabel text,
		synonym text,
		type text,
		ref text
	  ) SERVER csv_files OPTIONS (
	     filename '/tmp/tmpcsv/br_city_synonyms.csv',
	     format 'csv',
	     header 'true'
	  );
	
	    INSERT INTO dataset.big(source,key, c)
	      SELECT dataset.idconfig('br_city_synonyms') , concat(state::text,';',lexLabel::text,';',synonym::text), jsonb_build_array( state, lexlabel, synonym, type, ref   )
	      FROM tmpcsv_br_city_synonyms;
	  
	   DROP VIEW IF EXISTS dataset.vw_br_city_synonyms CASCADE; -- danger drop old dependents
	   CREATE VIEW dataset.vw_br_city_synonyms AS
		SELECT (c->>0)::text AS state, (c->>1)::text AS lexlabel, (c->>2)::text AS synonym, (c->>3)::text AS type, (c->>4)::text AS ref
		FROM dataset.big where source=dataset.idconfig('br_city_synonyms') ORDER BY 1,2,3;
	  

-- -- -- br_city_codes -- -- --

	   INSERT INTO dataset.meta(tmp_name,info) VALUES ('br_city_codes','{"name":"br-city-codes","path":"data/br-city-codes.csv","format":"csv","mediatype":"text/csv","rdfType":"http://schema.org/City","lang":"pt","schema":{"fields":[{"name":"name","description":"Official name of the city, in portuguese","rdfType-prop":"http://schema.org/name","title-pt":"Nome","title":"Name","type":"string"},{"name":"state","description":"State-name 2-letter abbreviation (in portuguese ''sigla da unidade da federação''), ISO 3166:BR","rdfType":"https://www.wikidata.org/wiki/Q27798","type":"string","title-pt":"Subdivisão (UF)","title":"Subdivision (Federal Unit)","regex":"^[A-Z]{2,2}$"},{"name":"wdId","description":"Wikidata concept (semantic) identifier","urlTpl":"https://www.wikidata.org/wiki/{value}","title-pt":"ID Wikidata","title":"Wikidata ID","type":"string"},{"name":"idIBGE","description":"IBGE statdandard identifier","url":"http://www.ibge.gov.br/home/geociencias/areaterritorial/principal.shtm","title-pt":"ID IBGE","title":"ID of IBGE","type":"string"},{"name":"lexLabel","description":"Brazilian''s LEX URN syntax translation of the official state name. Used in URLs and other contexts","url":"http://projeto.lexml.gov.br","title-pt":"Rótulo para URN-LEX","title":"Label for URN-LEX","type":"string"},{"name":"creation","description":"State official creation year","rdfType-prop":"http://schema.org/startDate","title-pt":"Ano de criação","title":"Creation year","type":"integer"},{"name":"extinction","description":"State official creation year (null for in use)","rdfType-prop":"http://schema.org/endDate","title-pt":"Ano de extinção","title":"Extinction year","type":"integer"},{"name":"postalCode_ranges","description":"Numeric ranges of postal codes","rdfType-ref":"https://schema.org/postalCode","title-pt":"Intervalos de CEP","title":"Postal-code ranges","type":"string"},{"name":"notes","description":"Notes about assegments, dates or changes","rdfType-prop":"http://schema.org/commentText","title-pt":"Notas","title":"Notes","type":"string"}]},"primaryKey":["state","lexLabel"]}'::jsonb);
	  
	 DROP FOREIGN TABLE IF EXISTS tmpcsv_br_city_codes CASCADE; -- danger drop VIEWS
	 CREATE FOREIGN TABLE tmpcsv_br_city_codes (
		name text,
		state text,
		wdid text,
		idibge text,
		lexlabel text,
		creation integer,
		extinction integer,
		postalcode_ranges text,
		notes text
	  ) SERVER csv_files OPTIONS (
	     filename '/tmp/tmpcsv/br_city_codes.csv',
	     format 'csv',
	     header 'true'
	  );
	
	    INSERT INTO dataset.big(source,key, c)
	      SELECT dataset.idconfig('br_city_codes') , concat(state::text,';',lexLabel::text), jsonb_build_array( name, state, wdid, idibge, lexlabel, creation, extinction, postalcode_ranges, notes   )
	      FROM tmpcsv_br_city_codes;
	  
	   DROP VIEW IF EXISTS dataset.vw_br_city_codes CASCADE; -- danger drop old dependents
	   CREATE VIEW dataset.vw_br_city_codes AS
		SELECT (c->>0)::text AS name, (c->>1)::text AS state, (c->>2)::text AS wdid, (c->>3)::text AS idibge, (c->>4)::text AS lexlabel, (c->>5)::integer AS creation, (c->>6)::integer AS extinction, (c->>7)::text AS postalcode_ranges, (c->>8)::text AS notes
		FROM dataset.big where source=dataset.idconfig('br_city_codes') ORDER BY 2,5;
	  